# Research: Decomposition of splurge-tools

Date: 2025-09-05T15:00

## Goal
Deprecate the monolithic `splurge_tools` by extracting coherent, reusable, independently versioned libraries. Preserve API ergonomics via transitional shims and maintain test parity.

## Current modules (inventory)
- `base58.py` (already split as `splurge-base58`)
- `dsv_helper.py` (already split as `splurge-dsv`)
- `type_helper.py` (hosted in `splurge-typer`; package currently has no CLI)
- `common_utils.py`
- `exceptions.py`
- `protocols.py`
- `data_validator.py`
- `path_validator.py`
- `data_transformer.py`
- `text_normalizer.py`
- `string_tokenizer.py`
- `case_helper.py`
- `text_file_helper.py`
- `resource_manager.py`
- `tabular_data_model.py`
- `typed_tabular_data_model.py`
- `streaming_tabular_data_model.py`
- `tabular_utils.py`
- `random_helper.py`
- `decorators.py`
- `factory.py`

## Coupling observations
- `typed_tabular_data_model` builds on `tabular_data_model` and `tabular_utils`.
- `streaming_tabular_data_model` relies on tabular abstractions and common utilities.
- Validation is cross-cutting; keep it lean and IO-free to avoid cycles.
- `protocols` and `exceptions` are widely used; position near core.
- IO helpers (`text_file_helper`, `resource_manager`) should not import tabular/text domains.
- `data_transformer` offers composition primitives reused by text and tabular workflows.

## Already externalized
- `splurge-base58` (modules: `splurge_base58.base58`; package also ships `__main__` and optional CLI module)
- `splurge-dsv` (modules: `dsv_helper`, `exceptions`, `path_validator`, `resource_manager`, `string_tokenizer`, `text_file_helper`; package also ships `__main__` and optional CLI module)
- `splurge-typer` (modules observed in .venv: `data_type`, `duck_typing`, `string`, `type_inference`)

## Risks
- PyPI naming availability and namespace consistency
- Backwards compatibility for imports from `splurge_tools.*`
- Hidden dependency cycles after split
- Test coverage drift when porting tests
- Performance parity for streaming/tabular paths

## Quality gates
- 1:1 unit test parity; keep e2e tests in `splurge-tools` during transition wired to new packages
- Transitional shims in `splurge_tools` re-exporting from new packages with `DeprecationWarning`
- Versioned deprecation schedule and CHANGELOG entries
 

## Candidate package boundaries
- Core: common utils, exceptions
- Protocols: runtime protocols and typing interfaces
- Validate: validators and path checks
- Transform: data transformation primitives
- Text: normalization, tokenization, casing
- IO: text file and resource helpers
- Tabular Core/Typed/Streaming: progressive layering
- Random: RNG helpers
- Decorators: function/class decorators
- Factory: registry/factory patterns

## Next steps
- Draft detailed plan with package map, dependency graph, and migration phases
- Confirm naming availability and CI/release strategy (monorepo vs multi-repo)
- Start with leaf packages (random, decorators, factory, text, io), then core/protocols/validate/transform, then tabular
